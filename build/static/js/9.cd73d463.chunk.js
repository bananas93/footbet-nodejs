(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[9],{306:function(e,t,a){e.exports={chatTitle:"ChatHeader_chatTitle__WJPXV",chatUserName:"ChatHeader_chatUserName__1TAYg",closeButton:"ChatHeader_closeButton__2IYD4"}},310:function(e,t,a){e.exports={chatMessage:"ChatMessage_chatMessage__rbyZZ",chatMessageRow:"ChatMessage_chatMessageRow__2y_dM",chatMessageInput:"ChatMessage_chatMessageInput__ol-7E",chatMessageEmoji:"ChatMessage_chatMessageEmoji__3ls4m",chatMessageTyping:"ChatMessage_chatMessageTyping__2bCTW",chatMessageButton:"ChatMessage_chatMessageButton__3dl94",chatMessagePage:"ChatMessage_chatMessagePage__2kufA"}},311:function(e,t,a){e.exports={chat:"ChatList_chat__18vs5",chatList:"ChatList_chatList__3va2e",chatListMessage:"ChatList_chatListMessage__20VMr",chatListMessageMy:"ChatList_chatListMessageMy__WOrl6",chatListWrapper:"ChatList_chatListWrapper__k2YWW",chatListTime:"ChatList_chatListTime__nquCK",chatListWrap:"ChatList_chatListWrap__KfX5J",chatListName:"ChatList_chatListName__8sx0G",chatListPage:"ChatList_chatListPage__3KvQA"}},312:function(e,t,a){e.exports={button:"Chat_button__31vsn"}},334:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return I}));var s=a(31),c=a(0),n=a(337),i=a(340),o=a(206),r=a(38),h=a.n(r),u=a(49),l=a(173),d=a.n(l),g=a(323),j=a(335),m=a(93),b=a(338),f=a(306),_=a.n(f),O=a(3);function p(e){var t=e.name,a=e.toggleShowChat;return Object(O.jsxs)("div",{className:_.a.chatTitle,children:[Object(O.jsx)("button",{type:"button",className:_.a.closeButton,onClick:a,children:Object(O.jsx)(m.a,{})}),Object(O.jsx)(j.a,{style:{backgroundColor:"#87d068"},icon:Object(O.jsx)(b.a,{})}),Object(O.jsx)("span",{className:_.a.chatUserName,children:t})]})}var x=a(339),M=a(319),v=a(310),L=a.n(v),C=a(56);function y(e){var t=e.isPage,a=e.handleSendMessage,n=Object(c.useState)(""),i=Object(s.a)(n,2),o=i[0],r=i[1],h=Object(c.useContext)(C.a).authorized,u=Object(c.useState)([]),l=Object(s.a)(u,2),d=l[0],g=l[1],j=Object(c.useContext)(C.b),m=function(){r(""),a(o)};return Object(c.useEffect)((function(){var e=function(){var e=h.name;j.emit("messageTyping",{name:e,typing:!1})};return window.addEventListener("beforeunload",e),j.on("typingUsers",(function(e){g(e)})),function(){window.removeEventListener("beforeunload",e)}}),[]),Object(O.jsxs)("div",{className:"".concat(L.a.chatMessage," ").concat(t?L.a.chatMessagePage:""),children:[Object(O.jsxs)("span",{className:L.a.chatMessageTyping,children:[d.map((function(e,t){return"".concat(t?", ":""," ").concat(e)}))," ",d.length?" \u043d\u0430\u0431\u0438\u0440\u0430\u0454 \u043f\u043e\u0432\u0456\u0434\u043e\u043c\u043b\u0435\u043d\u043d\u044f...":""]}),Object(O.jsxs)("div",{className:L.a.chatMessageRow,id:"message",children:[Object(O.jsx)(M.a,{onEnter:m,onChange:function(e){r(e);var t=h.name;e?j.emit("messageTyping",{name:t,typing:!0}):j.emit("messageTyping",{name:t,typing:!1})},value:o,fontFamily:"Nunito",height:40,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0456\u0442\u044c \u043f\u043e\u0432\u0456\u0434\u043e\u043c\u043b\u0435\u043d\u043d\u044f"}),Object(O.jsx)("button",{onClick:m,disabled:!o.length,className:L.a.chatMessageButton,type:"submit",children:Object(O.jsx)(x.a,{})})]})]})}var N=a(72),w=a.n(N),T=a(42),E=function(){var e=Object(u.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(T.b)("JWToken"),e.next=3,w.a.get("".concat("https://footbet.site/api","/chat"),{headers:{Authorization:t}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=a(311),P=a.n(S);function W(e){var t=e.isPage,a=e.setUnreadedMessages,n=e.toggleShowChat,i=Object(c.useContext)(C.b),r=Object(c.useState)([]),l=Object(s.a)(r,2),j=l[0],m=l[1],b=Object(c.useContext)(C.a).authorized;Object(c.useEffect)(Object(u.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E().then((function(e){if(200===e.status){m(e.data),window.localStorage.setItem("messages",JSON.stringify(e.data));var t=document.getElementById("chat-list");t.scrollTo(0,t.scrollHeight)}})).catch((function(e){console.error(e.message)}));case 2:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){i&&i.on("message",(function(e){a(!0),m((function(t){var a=Object(o.a)(t);return a[t.length-1].days.push(e),a})),setTimeout((function(){var e=document.getElementById("chat-list");e.scrollTo(0,e.scrollHeight)}),100)}))}),[]),Object(c.useEffect)((function(){return a(!1),document.documentElement.style.overflow="hidden",function(){document.documentElement.style.overflow="unset"}}),[]),Object(O.jsxs)("div",{className:P.a.chat,children:[!t&&Object(O.jsx)(p,{name:b.name,toggleShowChat:n}),Object(O.jsx)("ul",{id:"chat-list",className:"".concat(P.a.chatList," ").concat(t?P.a.chatListPage:""),children:j.map((function(e){return Object(O.jsxs)("div",{children:[Object(O.jsx)(g.a,{style:{fontWeight:"bold"},children:d()(e.date).format("LL")}),e.days.map((function(e){return Object(O.jsx)("li",{className:"".concat(P.a.chatListMessage," ").concat(e.user.id===b.id?P.a.chatListMessageMy:""),children:Object(O.jsx)("div",{className:P.a.chatListWrapper,children:Object(O.jsxs)("div",{className:P.a.chatListWrap,children:[e.user.id!==b.id&&Object(O.jsx)("div",{className:P.a.chatListName,children:e.user.name}),Object(O.jsxs)("div",{className:P.a.chatListText,children:[e.message,Object(O.jsx)("span",{className:P.a.chatListTime,children:d()(e.createdAt).format("HH:mm")})]})]})})},e.id)}))]},e.id)}))}),Object(O.jsx)(y,{isPage:!0,handleSendMessage:function(e){i.emit("chatMessage",e);var t={id:(new Date).getTime(),message:e,user:{id:b.id,name:b.name}},a=Object(o.a)(j);a[j.length-1].days.push(t),m(a),setTimeout((function(){var e=document.getElementById("chat-list");e.scrollTo(0,e.scrollHeight)}),100)}})]})}var k=a(312),B=a.n(k);function H(e){var t=e.isPage,a=Object(c.useState)(!!t),o=Object(s.a)(a,2),r=o[0],h=o[1],u=Object(c.useState)(!1),l=Object(s.a)(u,2),d=l[0],g=l[1],j=function(){h(!r)};return Object(O.jsx)(O.Fragment,{children:r?Object(O.jsx)(W,{isPage:t,setUnreadedMessages:g,toggleShowChat:j}):Object(O.jsx)("div",{className:B.a.button,children:Object(O.jsx)("button",{onClick:j,type:"button",children:Object(O.jsx)(n.a,{size:"default",dot:d,children:Object(O.jsx)(i.a,{style:{color:"#fff",fontSize:"25px"}})})})})})}function I(){return Object(O.jsx)(H,{isPage:!0})}}}]);
//# sourceMappingURL=9.cd73d463.chunk.js.map